Golang

Golang函数的return value不是原子操作，而是在编译器中分解为两部分，返回值赋值和return。而defer刚好被插入到末尾的return前执行。所以可以在defer函数中修改函数的返回值。

单个chan如果无缓冲的时候，将会阻塞。当结合select可以在多个chan间等待执行。
有三点原则：

1.select中只要有一个case能return，则立即执行。

2.当同一时间有多个case均能return，则伪随机方式抽取任意一个执行。

3.如果没有一个case能return则可以执行default语句。


sync.Map

1.sync.Map可以显著地减少锁的争用。虽然它也用到了锁，但是它在尽可能的避免使用锁。 

2.使用锁就意味着要把一些并发的操作串行化。这往往会降低程序的性能，尤其是在计算机拥有多个cpu核心的情况下。所以说能用原子操作就不要用锁。不过有局限性，原子只能对一些基本的数据结构提供支持。

3.sync.Map并发安全字典对于键的类型要求：键的实际类型不能是函数类型，字典类型和切片类型。

4.Go语言的原生字典的键类型不能是函数类型、字典类型和切片类型。

5.并发安全字典内部使用的存储介质正式原生字典。

6.保证并发安全字典中键和值的类型正确性：
1）让并发安全字典只能存储某个特定类型的值。使用类型断言表达式或者反射操作来保证他们的类型正确性。 
2）在初始化的时候确定好键的类型是可比较的，加入reflect.Type在程序运行的时候通过反射操作来进行检查。



